%% Author: Josh Meyer
%% 
%% This code is meant to generate speech sounds roughly based on a 
%% source-filter model.
%%


%%
%% HYPERPARAMETERS
%%

f0 = 100;
samplingRate = 44100;
numHarmonics = 40;



%%
%% SOURCE aka WHITE NOISE
%%

Source = wgn(numHarmonics,samplingRate,20);

%%
%% FILTER by GAUSSIAN MIXTURE MODEL
%%

harmonicIndeces = [1:numHarmonics];

%% F1
weight = .95;
mu(1:numHarmonics) = 30;
sigma(1:numHarmonics) = 1.5;
f1 = arrayfun(@uni_gauss_pdf,harmonicIndeces,mu,sigma);
f1 = times(weight,f1);


%% COMBINE COMPONENT GAUSSIANS TO MAKE GMM
mix = f1;
maxMix = max(mix);
mix = times(1/maxMix,mix);

plot(mix)


%%
%% APPLY FILTER TO SOURCE
%%

Filter = diag(mix);
FilteredSource = mtimes(Filter,Source);
newAudioSignal = sum(FilteredSource,1);
sound(newAudioSignal,samplingRate)
pause(1)

whos

exit()




